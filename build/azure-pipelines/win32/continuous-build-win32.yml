steps:
- task: NodeTool@0
  inputs:
    versionSpec: "8.12.0"
#- task: geeklearningio.gl-vsts-tasks-yarn.yarn-installer-task.YarnInstaller@2
#  inputs:
#    versionSpec: "1.10.1"
- powershell: |
    npm install -g yarn
  displayName: hernad - Install yarn with npm
- task: UsePythonVersion@0
  inputs:
    versionSpec: '2.x'
    addToPath: true
- powershell: |
    yarn
  displayName: Install Dependencies
- powershell: |
    yarn gulp electron
  displayName: Download Electron
# - powershell: |
#    yarn gulp hygiene
#  displayName: Run Hygiene Checks
- powershell: |
    yarn monaco-compile-check
  displayName: Run Monaco Editor Checks
- script: |
    yarn strict-null-check
  displayName: Run Strict Null Checks
- powershell: |
    yarn compile
  displayName: Compile Sources
- powershell: |
    yarn download-builtin-extensions
  displayName: Download Built-in Extensions
#- powershell: |
#    .\scripts\test.bat --tfs "Unit Tests"
#  displayName: Run Unit Tests
#- powershell: |
#    .\scripts\test-integration.bat --tfs "Integration Tests"
#  displayName: Run Integration Tests
#- task: PublishTestResults@2
#  displayName: Publish Tests Results
#  inputs:
#    testResultsFiles: '*-results.xml'
#    searchFolder: '$(Build.ArtifactStagingDirectory)/test-results'
#  condition: succeededOrFailed()

- powershell: |
    yarn gulp vscode-win32-ia32
    yarn gulp vscode-win32-ia32-archive
  displayName: "win32 build ia32 archive"


- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: '$(Build.ArtifactStagingDirectory)'
    artifactName: drop